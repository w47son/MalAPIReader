{"Enumeration": {"CreateToolhelp32Snapshot": "CreateToolhelp32Snapshot is used to enumerate processes, threads, and modules. This function is commonly used by malware to enumerate processes before process injection.", "EnumDeviceDrivers": "EnumDeviceDrivers is used to enumerate drivers in the machine. This function is commonly used with kernel malware or for enumeration purposes.", "EnumProcesses": "EnumProcesses is used to enumerate processes in the machine. Process enumeration is often a precursor to process injection.", "EnumProcessModules": "EnumProcessModules is used to enumerate the loaded modules (executables and DLLs) for a given process. Malware enumerates through modules when doing injection.", "EnumProcessModulesEx": "EnumProcessModulesEx is used to enumerate the loaded modules (executables and DLLs) for a given process. Malware enumerates through modules when doing injection.", "FindFirstFileA": "FindFirstFileA is used to search through a directory and enumerate the filesystem.", "FindNextFileA": "FindNextFileA is used to search through a directory and enumerate the filesystem.", "GetLogicalProcessorInformation": "GetLogicalProcessorInformation is used to retrieve information about logical processors and related hardware. The function is used by malware for anti-debugging purposes.", "GetLogicalProcessorInformationEx": "GetLogicalProcessorInformationEx is used to retrieve information about logical processors and related hardware. The function is used by malware for anti-debugging purposes.", "GetModuleBaseNameA": "GetModuleBaseNameA is used to retrieve the base name of a specified module.", "GetSystemDefaultLangId": "GetSystemDefaultLangId is used to retrieve the language identifier for the system. This function is used by malware that wish to infect specific locales or simply wish to gather statistics on areas of infection.", "GetVersionExA": "GetVersionExA is a classic method used to retrieve the Windows version.", "GetWindowsDirectoryA": "GetWindowsDirectoryA is used to retreive the path to the Windows directory. This function may be used by malware retrieve the Windows path for additional installations.", "IsWoW64Process": "IsWow64Process is used by a 32-bit process to determine if it is running on a 64-bit operating system.", "Module32First": "Module32First is used as part of CreateToolHelp32Snapshot for enumeration purposes.", "Module32Next": "Module32Next is used as part of CreateToolHelp32Snapshot for enumeration purposes.", "Process32First": "Process32First is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "Process32Next": "Process32Next is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "ReadProcessMemory": "ReadProcessMemory can be used to read the memory of a remote process.", "Thread32First": "Thread32First is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "Thread32Next": "Thread32Next is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "GetSystemDirectoryA": "GetSystemDirectoryA retrieve the path of the system directory.", "GetSystemTime": "GetSystemTime is used to retrieve the current system date and time in Coordinated Universal Time (UTC) format. This function is commonly used by malware for anti-debugging.", "ReadFile": "ReadFile is used to read data from the specified file or input/output (I/O) device.", "GetComputerNameA": "GetComputerNameA is used to retrieve the computer name. This is commonly used by malware for anti-debugging purposes.", "VirtualQueryEx": "VirtualQueryEx is used to retrieve information about a range of pages within the virtual address space of a specified process. This function is commonly used by malware to enumerate an external process.", "GetProcessIdOfThread": "GetProcessIdOfThread is used to retrieve the process identifier of the process associated with the specified thread.", "GetProcessId": "GetProcessId is used to retrieve the process identifier of the specified process.", "GetCurrentThread": "GetCurrentThread is used to retrieve a handle for the calling thread.", "GetCurrentThreadId": "GetCurrentThreadId is used to retrieve the thread identifier of the calling thread.", "GetThreadId": "GetThreadId is used to retrieve the thread identifier of the specified thread.", "GetThreadInformation": "GetThreadInformation is used to retrieve information about the specified thread.", "GetCurrentProcess": "GetCurrentProcess is used to retrieve a handle for the current process.", "GetCurrentProcessId": "GetCurrentProcessId is used to retrieve the process identifier of the calling process.", "SearchPathA": "SearchPathA is used to search for a specified file in a specified path.", "GetFileTime": "GetFileTime is used to retrieve the date and time that a file or directory was created, last accessed, and last modified.", "GetFileAttributesA": "GetFileAttributesA is used to retrieve file system attributes for a specified file or directory.", "LookupPrivilegeValueA": "LookupPrivilegeValueA is used to retrieve the locally unique identifier (LUID) used on a specified system to locally represent the specified privilege name. This function is commonly used by malware in process injection or token stealing.", "LookupAccountNameA": "LookupAccountNameA is used to accept the name of a system and an account as input. It retrieves a security identifier (SID) for the account and the name of the domain on which the account was found.", "GetCurrentHwProfileA": "GetCurrentHwProfileA is used to retrieve information about the current hardware profile for the local computer. This function is commonly used by malware to anti-debugging purposes.", "GetUserNameA": "GetUserNameA is used to retrieve the username associated with the current thread. This function is used by malware for anti-debugging purposes.", "RegEnumKeyExA": "RegEnumKeyExA is used to enumerate the subkeys of the specified open registry key.", "RegEnumValueA": "RegEnumValueA is used to enumerate the values for the specified open registry key", "RegQueryInfoKeyA": "RegQueryInfoKeyA is used to retrieves information about the specified registry key.", "RegQueryMultipleValuesA": "RegQueryMultipleValuesA is used to retrieve the type and data for a list of value names associated with an open registry key.", "RegQueryValueExA": "RegQueryValueExA is used to retrieve the type and data for the specified value name associated with an open registry key.", "NtQueryDirectoryFile": "NtQueryDirectoryFile is used to retrieve information about a directory. This function can be used for enumeration purposes.", "NtQueryInformationProcess": "NtQueryInformationProcess is used to retrieve information about a specified process.", "NtQuerySystemEnvironmentValueEx": "NtQuerySystemEnvironmentValueEx is used to locate a specified system environment variable and return its value.", "EnumDesktopWindows": "EnumDesktopWindows is used to enumerate all top-level windows associated with the specified desktop. This function is commonly used for enumeration purposes.", "EnumWindows": "EnumWindows is used to enumerate all top-level windows on the screen by passing the handle to each window, in turn, to an application-defined callback function. This function is commonly used for enumeration purposes.", "NetShareEnum": "NetShareEnum is used to retrieve information about each shared resource on a server.", "NetShareGetInfo": "NetShareGetInfo is used to retrieves information about a particular shared resource on a server.", "NetShareCheck": "NetShareCheck is used to check whether or not a server is sharing a device.", "GetAdaptersInfo": "GetAdaptersInfo is used to obtain information about the network adapters on the system. This function is commonly used by malware for enumeration purposes.", "PathFileExistsA": "PathFileExistsA is used to determine whether a path to a file system object such as a file or folder is valid. This function is used by malware to enumerate files and installed programs (e.g. AV solutions).", "GetNativeSystemInfo": "GetNativeSystemInfo is used to retrieve information about the current system to an application running under WOW64. If the function is called from a 64-bit application, or on a 64-bit system that does not have an Intel64 or x64 processor (such as ARM64), it is equivalent to the GetSystemInfo function.", "RtlGetVersion": "RtlGetVersion is used to enumerate OS basic information properties such Windows and build versions.", "GetIpNetTable": "The GetIpNetTable function retrieves the IPv4 to physical address mapping table. Could be used to identify hosts & mounted drives tracking ARP entries.", "GetLogicalDrives": "GetLogicalDrives is used to retrieve a bitmask representing the currently available disk drives. This function can be used to emumerate all drives / mounted drives.", "GetDriveTypeA": "GetDriveTypeA is used to determine whether a disk drive is a removable / fixed / CD-ROM / RAM disk or network drive.", "RegEnumKeyA": "RegEnumKeyA is used to enumerate the subkeys of the specified open registry key. The function retrieves the name of one subkey each time it is called.", "WNetEnumResourceA": "The WNetEnumResourceA function continues an enumeration of network resources that was started by a call to the WNetOpenEnum function.", "WNetCloseEnum": "The WNetCloseEnum function ends a network resource enumeration started by a call to the WNetOpenEnum function.", "FindFirstUrlCacheEntryA": "FindFirstUrlCacheEntryA is used to begin the enumeration of the Internet cache.", "FindNextUrlCacheEntryA": "FindNextUrlCacheEntryA is used to retrieve the next entry in the Internet cache.", "WNetAddConnection2A": "The WNetAddConnection2A function makes a connection to a network resource and can redirect a local device to the network resource. The WNetAddConnection2 function supersedes the WNetAddConnection function.", "WNetAddConnectionA": "The WNetAddConnectionA function enables the calling application to connect a local device to a network resource. A successful connection is persistent, meaning that the system automatically restores the connection during subsequent logon operations.", "EnumResourceTypesA": "EnumResourceTypesA is used to enumerate resource types within a binary module. Starting with Windows Vista, this is typically a language-neutral Portable Executable (LN file), and the enumeration also includes resources from one of the corresponding language-specific resource files (.mui files)\u00e2\u20ac\u201dif one exists\u00e2\u20ac\u201dthat contain localizable language resources. It is also possible to use hModule to specify a .mui file, in which case only that file is searched for resource types. Alternately, applications can call EnumResourceTypesEx, which provides more precise control over which resource files to enumerate.", "EnumResourceTypesExA": "EnumResourceTypesExA is used to enumerate resource types associated with a specified binary module. The search can include both a language-neutral Portable Executable file (LN file) and its associated .mui files. Alternately, it can be limited to a single binary module of any type, or to the .mui files associated with a single LN file. The search can also be limited to a single associated .mui file that contains resources for a specific language.", "GetSystemTimeAsFileTime": "Retrieves the current system date and time. The information is in Coordinated Universal Time (UTC) format. This function is commonly used by malware for anti-debugging.", "GetThreadLocale": "GetThreadLocale is used to retrieve the locale identifier of the current thread. Can be used alongside other language and/or locale APIs to geofence infections", "EnumSystemLocalesA": "EnumSystemLocalesA is used enumerate installed locale identifiers, all of the supported identifiers or alternate sort identifiers, according to which flag is passed to the API. Can be used to geofence infection campaigns or avoid infecting systems from a certain region/country. It can also be used to jump to allocated shellcode and execute it."}, "Injection": {"CreateFileMappingA": "CreateFileMappingA creates a handle to a file mapping that loads a file into memory and makes it accessible via memory addresses. Launchers, loaders, and injectors use this function to read and modify PE files.", "CreateProcessA": "CreateProcessA is used to create a process. This function is used by malware in several process injection attacks such as process hollowing.", "CreateRemoteThread": "CreateRemoteThread is used to create a thread that runs in the virtual address space of another process.", "CreateRemoteThreadEx": "CreateRemoteThreadEx is used to create a thread that runs in the virtual address space of another process.", "GetModuleHandleA": "GetModuleHandleW is used to retrieve a module handle for the specified module. The module must have been loaded by the calling process. This function is often used along with GetProcAddress to dynamically retrieve the address of a function for evasion purposes.", "GetProcAddress": "GetProcAddress is used to get the memory address of a function in a DLL. This is often used by malware for obfuscation and evasion purposes to avoid having to call the function directly.", "GetThreadContext": "GetThreadContext is used to retrieve a thread's context. This is often used as part of process injection techniques.", "HeapCreate": "HeapCreate is used to allocate heap memory that can be used by the calling process.", "LoadLibraryA": "LoadLibraryA is used to load a specified module into the address space of the calling process. Malware commonly use this to load DLLs dynamically for evasion purposes.", "LoadLibraryExA": "LoadLibraryExA is used to load a specified module into the address space of the calling process. Malware commonly use this to load DLLs dynamically for evasion purposes.", "LocalAlloc": "LocalAlloc is used for heap allocation and manipulation.", "MapViewOfFile": "MapViewOfFile is used for heap allocation and manipulation.", "MapViewOfFile2": "MapViewOfFile2 is used for heap allocation and manipulation.", "MapViewOfFile3": "MapViewOfFile3 is used for heap allocation and manipulation.", "MapViewOfFileEx": "MapViewOfFileEx is used for heap allocation and manipulation.", "OpenThread": "OpenThread is used to get a handle on a specified thread. It is commonly seen in process injection techniques.", "Process32First": "Process32First is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "Process32Next": "Process32Next is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "QueueUserAPC": "QueueUserAPC is used to execute code for a different thread. This function is commonly used as part of process injection.", "ReadProcessMemory": "ReadProcessMemory can be used to read the memory of a remote process.", "ResumeThread": "ResumeThread is used to resume a specified thread often times as part of process injection.", "SetProcessDEPPolicy": "SetProcessDEPPolicy is used to override the default DEP policy. Malware will use this function to allow data execution.", "SetThreadContext": "SetThreadContext is used to modify a thread's context. This is often used as part of process injection techniques.", "SuspendThread": "SuspendThread is used to suspend a specified thread often times as part of process injection or to tamper with a legitimate application.", "Thread32First": "Thread32First is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "Thread32Next": "Thread32Next is used as part of CreateToolhelp32Snapshot for enumeration purposes.", "Toolhelp32ReadProcessMemory": "Toolhelp32ReadProcessMemory can be used to read the memory of other processes.", "VirtualAlloc": "VirtualAlloc is often used by malware to allocate memory as part of process injection.", "VirtualAllocEx": "VirtualAllocEx is often used by malware to allocate memory in a remote process as part of process injection.", "VirtualProtect": "VirtualProtect is often used by malware to modify memory protection (often to allow write or execution).", "VirtualProtectEx": "VirtualProtectEx is often used by malware to modify memory protection in a remote process (often to allow write or execution).", "WriteProcessMemory": "Writing data into a specified region of memory. This function is often used by malware as part of process injection to inject malicious code into a specified process.", "VirtualAllocExNuma": "VirtualAllocExNuma is used to reserve or changes the state of a region of pages in the virtual address space of a specified process.", "VirtualAlloc2": "VirtualAlloc2 is used to reserve or changes the state of a region of pages in the virtual address space of a specified process.", "VirtualAlloc2FromApp": "VirtualAlloc2FromApp is used to reserve or changes the state of a region of pages in the virtual address space of the calling process.", "VirtualAllocFromApp": "VirtualAllocFromApp is used to reserve or changes the state of a region of pages in the virtual address space of the calling process.", "VirtualProtectFromApp": "VirtualProtectFromApp is used to change the protection on a region of committed pages in the virtual address space of the calling process.", "CreateThread": "CreateThread is used to create a thread to execute within the virtual address space of the calling process. This function is commonly used for shellcode execution.", "WaitForSingleObject": "WaitForSingleObject is used to delay the execution of an object. This function is commonly used to allow time for shellcode being executed within a thread to run. It is also used for time-based evasion.", "OpenProcess": "OpenProcess is used to get a handle on a process. This function is commonly used by malware during process injection.", "OpenFileMappingA": "OpenFileMappingA is used to open a named file mapping object.", "GetProcessHeap": "GetProcessHeap is used to retrieve a handle to the default heap of the calling process.", "GetProcessHeaps": "GetProcessHeaps is used to return the number of active heaps and retrieves handles to all of the active heaps for the calling process.", "HeapAlloc": "HeapAlloc is used to allocate a block of memory from a heap.", "HeapReAlloc": "HeapReAlloc is used to reallocate a block of memory from a heap.", "GlobalAlloc": "GlobalAlloc is used to allocate the specified number of bytes from the heap.", "AdjustTokenPrivileges": "AdjustTokenPrivileges is used to enable or disable specific access privileges. Malware that performs process injection often calls this function to gain additional permissions.", "CreateProcessAsUserA": "CreateProcessAsUserA is used to create a new process and its primary thread.", "OpenProcessToken": "OpenProcessToken is used to open the access token associated with a process.", "CreateProcessWithTokenW": "CreateProcessWithTokenW is used to create a new process and its primary thread.", "NtAdjustPrivilegesToken": "NtAdjustPrivilegesToken is used to modify state of avaiable token's privileges. This function is often used by malware that performs process injection often calls this function to gain additional permissions.", "NtAllocateVirtualMemory": "NtAllocateVirtualMemoy is used to reserve, commit, or both, a region of pages within the user-mode virtual address space of a specified process.", "NtContinue": "NtContinue is used to resume the execution of a thread.", "NtCreateProcess": "NtCreateProcess is used to create a new process.", "NtCreateProcessEx": "NtCreateProcessEx is used to create a new process.", "NtCreateSection": "NtCreateSection is used to create a new section object.", "NtCreateThread": "NtCreateThread is used to create a new thread.", "NtCreateThreadEx": "NtCreateThreadEx is used to create a new thread.", "NtCreateUserProcess": "NtCreateUserProcess is used to create a new process.", "NtDuplicateObject": "NtDuplicateObject is used to create a handle that is a duplicate of the specified source handle. Malware can use this function to obtain the necessary access rights to a process via duplicating its handle, and subsequently kill a process or inject into it.", "NtMapViewOfSection": "NtMapViewOfSection is used to map a view of a section into the virtual address space of a subject process. This function is used by malware as part of process injection.", "NtOpenProcess": "NtOpenProcess is used to get a handle on a process. This function is commonly used as part of process injection.", "NtOpenThread": "NtOpenThread is used to get a handle on a thread. This function is commonly used as part of process injection.", "NtProtectVirtualMemory": "NtProtectVirtualMemory is used to interact with and modify memory regions.", "NtQueueApcThread": "NtQueueApcThread is used to execute code for a different thread. This function is commonly used as part of process injection.", "NtQueueApcThreadEx": "NtQueueApcThreadEx is used to execute code for a different thread. This function is commonly used as part of process injection.", "NtQueueApcThreadEx2": "NtQueueApcThreadEx2 is a new system call that allows to pass both UserApcFlags and MemoryReserveHandle.", "NtReadVirtualMemory": "NtReadVirtualMemory is used to copy data in the specified address range from the address space of the specified process into the specified buffer of the current process", "NtResumeThread": "NtResumeThread is used to resume a suspended thread.", "NtUnmapViewOfSection": "NtUnmapViewOfSection is used to unmap a view of a section from the virtual address space of a subject process.", "NtWaitForMultipleObjects": "NtWaitForMultipleObjects is used to wait until one or all of the specified objects are in the signaled state or the time-out interval elapses. This function is commonly used by malware for evasion purposes", "NtWaitForSingleObject": "NtWaitForSingleObject is used to wait until the specified object is in the signaled state or the time-out interval elapses. This function is commonly used by malware for evasion purposes.", "NtWriteVirtualMemory": "NtWriteVirtualMemory is used to copy the specified address range from the current process into the specified address range of the specified process.", "RtlCreateHeap": "RtlCreateHeap is used to create a heap object that can be used by the calling process.", "LdrLoadDll": "LdrLoadDll is used instead of LoadLibrary to load modules.", "RtlMoveMemory": "RtlMoveMemory is used to copy the contents of a source memory block to a destination memory block, and supports overlapping source and destination memory blocks.", "RtlCopyMemory": "RtlCopyMemory is used to copy the contents of a source memory block to a destination memory block.", "SetPropA": "SetPropA is used to add a new entry or changes an existing entry in the property list of the specified window. This function is commonly used by malware to register a property and wait for its invocation to execute malicious commands.", "WaitForSingleObjectEx": "WaitForSingleObjectEx is used to delay the execution of an object. This function is commonly used to allow time for shellcode being executed within a thread to run. It is also used for time-based evasion.", "WaitForMultipleObjects": "WaitForMultipleObjects is used to wait until one or all of the specified objects are in the signaled state or the time-out interval elapses. This function is commonly used to allow time for shellcode to execute or for time-based evasion.", "WaitForMultipleObjectsEx": "WaitForMultipleObjectsEx is used to wait until one or all of the specified objects are in the signaled state or the time-out interval elapses. This function is commonly used to allow time for shellcode to execute or for time-based evasion.", "KeInsertQueueApc": "KeInsertQueueApc is responsible for attaching an initialized APC to the APC queue of its target thread", "Wow64SetThreadContext": "Wow64SetThreadContext is used to set the context for the specified thread. This function can be used by malware as part of a process hollowing attack.", "NtSuspendProcess": "NtSuspendProcess is used to suspend the target process", "NtResumeProcess": "NtResumeProcess is used to resume a suspended process", "DuplicateToken": "The DuplicateToken function creates a new access token that duplicates one already in existence.", "NtReadVirtualMemoryEx": "NtReadVirtualMemoryEx is used to copy data in the specified address range from the address space of the specified process into the specified buffer of the current process", "CreateProcessInternal": "CreateProcessInternal is an undocumented API for process creation. According to Windows Internals, CreateProcess and CreateProcessAsUser actually lead to this API, which is responsible for starting the process creation in user land. Eventually it calls NtCreateUserProcess for the kernel land operations. This API is commonly used for spawning a suspended process to be hollowed/injected.", "EnumSystemLocalesA": "EnumSystemLocalesA is used enumerate installed locale identifiers, all of the supported identifiers or alternate sort identifiers, according to which flag is passed to the API. Can be used to geofence infection campaigns or avoid infecting systems from a certain region/country. It can also be used to jump to allocated shellcode and execute it.", "UuidFromStringA": "UuidFromStringA is used to convert a string to a UUID. This function can be abused to both decode data and write it to memory without using common functions such as memcpy or WriteProcessMemory."}, "Evasion": {"CreateFileMappingA": "CreateFileMappingA creates a handle to a file mapping that loads a file into memory and makes it accessible via memory addresses. Launchers, loaders, and injectors use this function to read and modify PE files.", "DeleteFileA": "DeleteFileA is used to delete an existing file. This function is used by malware to hide its tracks or tamper with an application.", "GetModuleHandleA": "GetModuleHandleW is used to retrieve a module handle for the specified module. The module must have been loaded by the calling process. This function is often used along with GetProcAddress to dynamically retrieve the address of a function for evasion purposes.", "GetProcAddress": "GetProcAddress is used to get the memory address of a function in a DLL. This is often used by malware for obfuscation and evasion purposes to avoid having to call the function directly.", "LoadLibraryA": "LoadLibraryA is used to load a specified module into the address space of the calling process. Malware commonly use this to load DLLs dynamically for evasion purposes.", "LoadLibraryExA": "LoadLibraryExA is used to load a specified module into the address space of the calling process. Malware commonly use this to load DLLs dynamically for evasion purposes.", "LoadResource": "LoadResource is used to load a resource from a PE file into memory. Malware sometimes uses resources to store strings, configuration information, or other malicious files.", "SetEnvironmentVariableA": "SetEnvironmentVariableA sets the contents of the specified environment variable for the current process.  Setting custom envrinoment variables can be used for obfuscation and evasion purposes.", "SetFileTime": "SetFileTime sets the date and time that the specified file or directory was created, last accessed, or last modified. This function is often used by malware to conceal malicious activity.", "Sleep": "Sleep is used to suspend the execution of the current thread for a set time. This function is commonly used for time-based evasion by adding delays in the code.", "WaitForSingleObject": "WaitForSingleObject is used to delay the execution of an object. This function is commonly used to allow time for shellcode being executed within a thread to run. It is also used for time-based evasion.", "SetFileAttributesA": "SetFileAttributesA is used to set attributes of a file or directory. This function is commonly used by malware to make a file or directory hidden.", "SleepEx": "SleepEx is used to suspend the execution of the current thread for a set time. This function is commonly used for time-based evasion by adding delays in the code.", "NtDelayExecution": "NtDelayExecution is used to suspend execution, similiar to the Sleep() API function. This function can be used by malware for evasion purposes.", "NtWaitForMultipleObjects": "NtWaitForMultipleObjects is used to wait until one or all of the specified objects are in the signaled state or the time-out interval elapses. This function is commonly used by malware for evasion purposes", "NtWaitForSingleObject": "NtWaitForSingleObject is used to wait until the specified object is in the signaled state or the time-out interval elapses. This function is commonly used by malware for evasion purposes.", "CreateWindowExA": "CreateWindowExA is used to create an overlapped, pop-up, or child window with an extended window style. This function is commonly used by malware to create invisible windows or for evasion purposes.", "RegisterHotKey": "RegisterHotKey is used to create a system wide hotkey. This function is commonly used by spyware or keyloggers to recieve a notification when a certain combination of keys are pressed.", "timeSetEvent": "timeSetEvent is used to start a specified timer event. This function is obselete but is still used by malware for time-based evasion.", "IcmpSendEcho": "IcmpSendEcho is used to send an IPv4 ICMP echo request and returns any echo response replies. The call returns when the time-out has expired or the reply buffer is filled. This function is used by malware for time-evasion purposes by specifying a large timeout value.", "WaitForSingleObjectEx": "WaitForSingleObjectEx is used to delay the execution of an object. This function is commonly used to allow time for shellcode being executed within a thread to run. It is also used for time-based evasion.", "WaitForMultipleObjects": "WaitForMultipleObjects is used to wait until one or all of the specified objects are in the signaled state or the time-out interval elapses. This function is commonly used to allow time for shellcode to execute or for time-based evasion.", "WaitForMultipleObjectsEx": "WaitForMultipleObjectsEx is used to wait until one or all of the specified objects are in the signaled state or the time-out interval elapses. This function is commonly used to allow time for shellcode to execute or for time-based evasion.", "SetWaitableTimer": "SetWaitableTimer is used to activate the specified waitable timer. This function is commonly used by malware for time-based evasion.", "CreateTimerQueueTimer": "CreateTimerQueueTimer is used to create a timer-queue timer. This function is commonly used by malware for time-based evasion.", "CreateWaitableTimer": "CreateWaitableTimer is used to create a delay timer. This function is used by malware for time-based evasion.", "SetTimer": "SetTimer is used to create a timer with the specified time-out value. This function is commonly used by malware for time-based evasion", "Select": "Select is used to determine the status of one or more sockets, waiting if necessary, to perform synchronous I/O. This function is used by malware for time-based evasion by setting a large timeout number.", "ImpersonateLoggedOnUser": "The ImpersonateLoggedOnUser function lets the calling thread impersonate the security context of a logged-on user. The user is represented by a token handle.", "SetThreadToken": "The SetThreadToken function assigns an impersonation token to a thread. The function can also cause a thread to stop using an impersonation token.", "DuplicateToken": "The DuplicateToken function creates a new access token that duplicates one already in existence.", "SizeOfResource": "SizeOfResource checks and retrieves the size of given resource. Usually found in droppers", "LockResource": "LockResource is used with FindResource(), LoadResource() and SizeOfResource() usually to work with embedded executables into the .rsrc section (droppers)", "CreateProcessInternal": "CreateProcessInternal is an undocumented API for process creation. According to Windows Internals, CreateProcess and CreateProcessAsUser actually lead to this API, which is responsible for starting the process creation in user land. Eventually it calls NtCreateUserProcess for the kernel land operations. This API is commonly used for spawning a suspended process to be hollowed/injected.", "TimeGetTime": "TimeGetTime is used to retrieve the system time, in milliseconds. The system time is the time elapsed since Windows was started.", "EnumSystemLocalesA": "EnumSystemLocalesA is used enumerate installed locale identifiers, all of the supported identifiers or alternate sort identifiers, according to which flag is passed to the API. Can be used to geofence infection campaigns or avoid infecting systems from a certain region/country. It can also be used to jump to allocated shellcode and execute it.", "UuidFromStringA": "UuidFromStringA is used to convert a string to a UUID. This function can be abused to both decode data and write it to memory without using common functions such as memcpy or WriteProcessMemory."}, "Spying": {"AttachThreadInput": "AttachThreadInput is used to attach the input processing from one thread to another so that the second thread receives input events such as keyboard and mouse events. This function is commonly used by keyloggers.", "CallNextHookEx": "CallNextHookEx is used within code that is hooking an event set by SetWindowsHookEx. CallNextHookEx calls the next hook in the chain. This function is commonly used by keyloggers.", "GetAsyncKeyState": "GetAsyncKeyState is used to determine when a specific key is pressed. This function is commonly used by keyloggers.", "GetClipboardData": "GetClipboardData is used to retrieve copied data residing in the clipboard.", "GetDC": "GetDC is used to retrieve a handle to a device context (DC) for the client area of a specified window or for the entire screen. This function is commonly used by spyware for taking screenshots.", "GetDCEx": "GetDCEx is used to retrieve a handle to a device context (DC) for the client area of a specified window or for the entire screen. This function is commonly used by spyware for taking screenshots.", "GetForegroundWindow": "GetForegroundWindow is used to get a handle to the foreground window (the window with which the user is currently working). This function is commonly used by keyloggers and spyware to determine which window is being utilized at the moment by the user.", "GetKeyboardState": "GetKeyboardState is used to copy the status of the 256 virtual keys to the specified buffer. This function is commonly used by keyloggers.", "GetKeyState": "GetKeyState is used to retrieve the status of the specified virtual key. This function is commonly used by keyloggers.", "GetMessageA": "GetMessageA is used to retrieve a message from the calling thread's message queue. This function is commonly used by keyloggers.", "GetRawInputData": "GetRawInputData is used to retrieve the raw input data from a specified device. This function is commonly used by keyloggers.", "GetWindowDC": "GetWindowDC is used to retrieve the device context (DC) for the entire window, including title bar, menus, and scroll bars. This function is commonly used by spyware and keyloggers to capture screenshots.", "MapVirtualKeyA": "MapVirtualKeyA is used to map a virtual-key code into a scan code or character value, or translates a scan code into a virtual-key code. This function is commonly used by spyware and keyloggers.", "MapVirtualKeyExA": "MapVirtualKeyExA is used to map a virtual-key code into a scan code or character value, or translates a scan code into a virtual-key code. This function is commonly used by spyware and keyloggers.", "PeekMessageA": "PeekMessageA is used to check for incoming sent messages, checks the thread message queue for a posted message, and retrieves the message (if any exist).", "PostMessageA": "PostMessageA is used to post a message in the message queue associated with the thread that created the specified window and returns without waiting for the thread to process the message.", "PostThreadMessageA": "PostThreadMessageA is used to post a message to the message queue of the specified thread.", "RegisterHotKey": "RegisterHotKey is used to create a system wide hotkey. This function is commonly used by spyware or keyloggers to recieve a notification when a certain combination of keys are pressed.", "RegisterRawInputDevices": "RegisterRawInputDevices is used to register the devices that supply raw input.", "SendMessageA": "SendMessageA is used to send the specified message to a window or windows.", "SendMessageCallbackA": "SendMessageCallbackA is used to send the specified message to a window or windows.", "SendMessageTimeoutA": "SendMessageTimeoutA is used to send the specified message to a window or windows.", "SendNotifyMessageA": "SendNotifyMessageA is used to send the specified message to a window or windows.", "SetWindowsHookExA": "SetWindowsHookExA is used to install an application-defined hook procedure into a hook chain. This function is commonly used by keyloggers.", "SetWinEventHook": "SetWinEventHook is used to set an event hook function for a range of events.", "UnhookWindowsHookEx": "UnhookWindowsHookEx is used to remove a hook procedure installed in a hook chain by the SetWindowsHookEx function.", "BitBlt": "BitBlt is used to copy graphic data from one device to another. Spyware sometimes uses this function to capture screenshots.", "StretchBlt": "StretchBlt is used to copy graphic data from one device to another. Spyware sometimes uses this function to capture screenshots.", "GetKeynameTextA": "The GetKeynameTextA function is used to retrieve a string that represents the name of a key."}, "Internet": {"WinExec": "WinExec is used to allow the execution of an application.", "FtpPutFileA": "FtpPutFileA is used to upload a file to a server via FTP.", "HttpOpenRequestA": "HttpOpenRequestA is used to create a HTTP request.", "HttpSendRequestA": "HttpSendRequestA is used to send a HTTP request to a server.", "HttpSendRequestExA": "HttpSendRequestExA is used to send a HTTP request to a server", "InternetCloseHandle": "InternetCloseHandle is used to close an internet handle.", "InternetOpenA": "InternetOpenA is used to initialize the use of WinINet functions.", "InternetOpenUrlA": "InternetOpenUrlA is used to open a resource specified by a complete FTP or HTTP URL.", "InternetReadFile": "InternetReadFile is used to read data from a handle opened by the InternetOpenUrl, FtpOpenFile, or HttpOpenRequest function.", "InternetReadFileExA": "InternetReadFileExA is used to read data from a handle opened by the InternetOpenUrl or HttpOpenRequest function.", "InternetWriteFile": "InternetWriteFile is used to write data to an open Internet file.", "URLDownloadToFile": "URLDownloadToFile is used to download bits from the Internet and saves them to a file.", "URLDownloadToCacheFile": "URLDownloadToCacheFile is used to download data to the Internet cache and returns the file name of the cache location for retrieving the bits.", "URLOpenBlockingStream": "URLOpenBlockingStream is used to create a blocking type stream object from a URL and downloads the data from the Internet.", "URLOpenStream": "URLOpenStream is used to create a push type stream object from a URL.", "Accept": "Accept is used to permit an incoming connection attempt on a socket.", "Bind": "Bind is used to associates a local address with a socket.", "Connect": "Connect is used to establish a connection to a specified socket.", "Gethostbyname": "gethostbyname is used to retrieve host information corresponding to a host name from a host database.", "Inet_addr": "inet_addr is used to convert a string containing an IPv4 dotted-decimal address into a proper address for the IN_ADDR structure.", "Recv": "Recv is used to receive data from a connected socket or a bound connectionless socket.", "Send": "Send is used to send data on a connected socket.", "WSAStartup": "WSAStartup is used to initiate use of the Winsock DLL by a process.", "Gethostname": "gethostname is used to retrieve the standard host name for the local computer.", "Socket": "socket is used create a socket that is bound to a specific transport service provider.", "WSACleanup": "WSACleanup is used to terminate the use of the Winsock 2 DLL. This function is commonly used by malware upon successfully utilizing the Winsock 2 functions.", "Listen": "Listen is used to place a socket in a state in which it is listening for an incoming connection.", "ShellExecuteA": "ShellExecuteA is used to perform an operation on a specified file.", "ShellExecuteExA": "ShellExecuteExA is used to perform an operation on a specified file.", "DnsQuery_A": "DnsQuery_A is used to send a DNS query. This may be used for communications over a DNS tunnel.", "DnsQueryEx": "DnsQueryEx is used to send a DNS query. This may be used for communications over a DNS tunnel.", "WNetOpenEnumA": "The WNetOpenEnumA function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the WNetEnumResource function.", "FindFirstUrlCacheEntryA": "FindFirstUrlCacheEntryA is used to begin the enumeration of the Internet cache.", "FindNextUrlCacheEntryA": "FindNextUrlCacheEntryA is used to retrieve the next entry in the Internet cache.", "InternetConnectA": "InternetConnectA is used to open a File Transfer Protocol (FTP) or HTTP session for a given site.", "InternetSetOptionA": "InternetSetOptionA is used to set an Internet option.", "WSASocketA": "WSASocketA is used to create a socket that is bound to a specific transport-service provider.", "Closesocket": "Closesocket is used to close an existing socket.", "WSAIoctl": "WSAIoctl Can be used to retrieve and set socket mode. E.g.: Put NIC in 'Promiscuous Mode'", "ioctlsocket": "ioctlsocket takes control of the I/O mode of a socket in any state", "HttpAddRequestHeaders": "HttpAddRequestHeaders adds HTTP request headers to forge custom request handle"}, "Anti-Debugging": {"CreateToolhelp32Snapshot": "CreateToolhelp32Snapshot is used to enumerate processes, threads, and modules. This function is commonly used by malware to enumerate processes before process injection.", "GetLogicalProcessorInformation": "GetLogicalProcessorInformation is used to retrieve information about logical processors and related hardware. The function is used by malware for anti-debugging purposes.", "GetLogicalProcessorInformationEx": "GetLogicalProcessorInformationEx is used to retrieve information about logical processors and related hardware. The function is used by malware for anti-debugging purposes.", "GetTickCount": "GetTickCount is used to retrieve the number of milliseconds since bootup. This function is used by malware for anti-debugging purposes.", "OutputDebugStringA": "OutputDebugStringA sends a string to the debugger for display. This function can be used as an anti-debugging technique.", "CheckRemoteDebuggerPresent": "CheckRemoteDebuggerPresent is used to check if a debugger is being used. This function is commonly used by malware for anti-debugging techniques.", "Sleep": "Sleep is used to suspend the execution of the current thread for a set time. This function is commonly used for time-based evasion by adding delays in the code.", "GetSystemTime": "GetSystemTime is used to retrieve the current system date and time in Coordinated Universal Time (UTC) format. This function is commonly used by malware for anti-debugging.", "GetComputerNameA": "GetComputerNameA is used to retrieve the computer name. This is commonly used by malware for anti-debugging purposes.", "SleepEx": "SleepEx is used to suspend the execution of the current thread for a set time. This function is commonly used for time-based evasion by adding delays in the code.", "IsDebuggerPresent": "IsDebuggerPresent is used to determine whether the calling process is being debugged by a user-mode debugger.", "GetUserNameA": "GetUserNameA is used to retrieve the username associated with the current thread. This function is used by malware for anti-debugging purposes.", "NtQueryInformationProcess": "NtQueryInformationProcess is used to retrieve information about a specified process.", "ExitWindowsEx": "ExitWindowsEx is used to log off an interactive user, shuts down the system, or shuts down and restarts the system. This function is commonly used by malware as an anti-debugging technique.", "FindWindowA": "FindWindowA is used to get a handle to the top-level window whose class name and window name match the specified strings. This function is commonly used by malware as an anti-debugging technique.", "FindWindowExA": "FindWindowExA is used to get a handle to the top-level window whose class name and window name match the specified strings. This function is commonly used by malware as an anti-debugging technique.", "GetForegroundWindow": "GetForegroundWindow is used to get a handle to the foreground window (the window with which the user is currently working). This function is commonly used by keyloggers and spyware to determine which window is being utilized at the moment by the user.", "GetTickCount64": "GetTickCount64 is used to retrieve the number of milliseconds that have elapsed since the system was started. This function is used by malware for anti-debugging purposes by checking how long the system uptime is.", "QueryPerformanceFrequency": "QueryPerformanceFrequency is used to retrieve the frequency of the performance counter. This function is commonly used by malware for anti-debugging purposes. The malware will measure the time before and after an operation, if the time exceeds taken expected time, the malware will terminate or activate a benign function.", "QueryPerformanceCounter": "QueryPerformanceCounter is used to retrieve the frequency of the performance counter. This function is commonly used by malware for anti-debugging purposes. The malware will measure the time before and after an operation, if the time exceeds taken expected time, the malware will terminate or activate a benign function.", "GetNativeSystemInfo": "GetNativeSystemInfo is used to retrieve information about the current system to an application running under WOW64. If the function is called from a 64-bit application, or on a 64-bit system that does not have an Intel64 or x64 processor (such as ARM64), it is equivalent to the GetSystemInfo function.", "RtlGetVersion": "RtlGetVersion is used to enumerate OS basic information properties such Windows and build versions.", "GetSystemTimeAsFileTime": "Retrieves the current system date and time. The information is in Coordinated Universal Time (UTC) format. This function is commonly used by malware for anti-debugging.", "CountClipboardFormats": "CountClipboardFormats is used to determine whether victim's clipboard was empty. A kind of Anti-debugging technique to determine if the system could be a sandbox."}, "Ransomware": {"CryptAcquireContextA": "CryptAcquireContextA is used to acquire a handle to a particular key container within a particular cryptographic service provider (CSP)", "EncryptFileA": "EncryptFileA is used to encrypt a file or directory.", "CryptEncrypt": "CryptEncrypt is used to encrypt data.", "CryptDecrypt": "CryptDecrypt is used to decrypt data.", "CryptCreateHash": "CryptCreateHash is used to create a hash.", "CryptHashData": "CryptHashData is used to create a hash.", "CryptDeriveKey": "CryptDeriveKey is used to create encryption keys.", "CryptSetKeyParam": "CryptSetKeyParam is used to customize various aspects of a session key's operations.", "CryptGetHashParam": "CryptGetHashParam", "CryptDestroyKey": "CryptDestroyKey is used to destroy previously generated encryption keys.", "CryptGenRandom": "CryptGenRandom is used to fill a buffer with cryptographically random bytes.", "DecryptFileA": "DecryptFileA is used to decrypt an encrypted file or directory.", "FlushEfsCache": "FlushEfsCache is used to flush EFS data from memory. This is used by EFS ransomware post-encryption to cause the files and folder to become unreadable.", "GetLogicalDrives": "GetLogicalDrives is used to retrieve a bitmask representing the currently available disk drives. This function can be used to emumerate all drives / mounted drives.", "GetDriveTypeA": "GetDriveTypeA is used to determine whether a disk drive is a removable / fixed / CD-ROM / RAM disk or network drive.", "CryptStringToBinary": "The CryptStringToBinary function is used to convert a formatted string into an array of bytes.", "CryptBinaryToString": "The CryptBinaryToString function is used to convert an array of bytes into a formatted string.", "CryptReleaseContext": "The CryptReleaseContext function is used to release the handle of a cryptographic service provider (CSP) and a key container.", "CryptDestroyHash": "The CryptDestroyHash function destroys the hash object referenced by the hHash parameter. After a hash object has been destroyed, it can no longer be used.", "EnumSystemLocalesA": "EnumSystemLocalesA is used enumerate installed locale identifiers, all of the supported identifiers or alternate sort identifiers, according to which flag is passed to the API. Can be used to geofence infection campaigns or avoid infecting systems from a certain region/country. It can also be used to jump to allocated shellcode and execute it."}, "Helper": {"ConnectNamedPipe": "ConnectNamedPipe is used to create a server pipe for interprocess communication that will wait for a client pipe to connect. This function can be used to simplify connectivity to a C2 server.", "CopyFileA": "CopyFileA is used to copy an existing file to a new file.", "CreateFileA": "CreateFileA is used to create a new file or opens an existing file.", "CreateMutexA": "CreateMutexA is used to create a new mutex object. Mutexs are often used by malware to prevent the reinfection of a system with the same or different malware variant.", "CreateMutexExA": "CreateMutexExA is used to create a new mutex object. Mutexs are often used by malware to prevent the reinfection of a system with the same or different malware variant.", "DeviceIoControl": "DeviceIoControl is used to send a control message from user space to a device driver. DeviceIoControl is popular with kernel malware because it is an easy, flexible way to pass information between user space and kernel space.", "FindResourceA": "FindResourceA is used to find a resource in an executable or loaded DLL. Malware sometimes uses resources to store strings, configuration information, or other malicious files. If you see this function used, check for a .rsrc section in the malware\u2019s PE header.", "FindResourceExA": "FindResourceExA is used to find a resource in an executable or loaded DLL. Malware sometimes uses resources to store strings, configuration information, or other malicious files. If you see this function used, check for a .rsrc section in the malware\u2019s PE header.", "GetModuleBaseNameA": "GetModuleBaseNameA is used to retrieve the base name of a specified module.", "GetModuleFileNameA": "GetModuleFileNameA is used to return the filename of a module that is loaded in the current process. Malware can use this function to modify or copy files in the currently running process.", "GetModuleFileNameExA": "GetModuleFileNameExA is used to return the filename of a module that is loaded in the current process. Malware can use this function to modify or copy files in the currently running process.", "GetTempPathA": "GetTempPathA is used to retrieve the path of the directory designated for temporary files. This is often used by malware when it requires a location for additional installations.", "IsWoW64Process": "IsWow64Process is used by a 32-bit process to determine if it is running on a 64-bit operating system.", "MoveFileA": "MoveFileA is used to move an existing file or a directory, including its children.", "MoveFileExA": "MoveFileExA is used to move an existing file or a directory, including its children.", "PeekNamedPipe": "Used to copy data from a named pipe without removing data from the pipe. This function has been used by exploits targeting SMB vulnerabilities.", "WriteFile": "WriteFile is used to write data to the specified file or input/output (I/O) device.", "TerminateThread": "TerminateThread is used to terminate a thread.", "CopyFile2": "CopyFile2 is used to copy an existing file to a new file.", "CopyFileExA": "CopyFileExA is used to copy an existing file to a new file.", "CreateFile2": "CreateFile2 is used to create a new file or opens an existing file.", "GetTempFileNameA": "GetTempFileNameA is used to create a name for a temporary file. If a unique file name is generated, an empty file is created and the handle to it is released; otherwise, only a file name is generated.", "TerminateProcess": "TerminateProcess is used to terminate a process.", "SetCurrentDirectory": "SetCurrentDirectory is used to change the current directory for the current process.", "FindClose": "FindClose is used to close a file search handle.", "SetThreadPriority": "SetThreadPriority is used to set the priority value for the specified thread. This value, together with the priority class of the thread's process, determines the thread's base priority level.", "UnmapViewOfFile": "UnmapViewOfFile is used to unmap a mapped view of a file from the calling process's address space.", "ControlService": "ControlService is used to start, stop, modify, or send a signal to a running service. This function is commonly used by malware went it requires interaction with a service for malicious purposes.", "ControlServiceExA": "ControlServiceExA is used to start, stop, modify, or send a signal to a running service. This function is commonly used by malware went it requires interaction with a service for malicious purposes.", "CreateServiceA": "CreateServiceA is used to create a service object and adds it to the specified service control manager database. This function is commonly used by malware for persistence.", "DeleteService": "DeleteService is used to mark the specified service for deletion from the service control manager database.", "OpenSCManagerA": "OpenSCManagerA is used to open a handle to the service control manager. This function is commonly used when a malware intends to interact with a service.", "OpenServiceA": "OpenServiceA is used to open an existing service.", "RegOpenKeyA": "RegOpenKeyA is used to open a specified registry key.", "RegOpenKeyExA": "RegOpenKeyExA is used to open a specified registry key.", "StartServiceA": "StartServiceA is used to start a service.", "StartServiceCtrlDispatcherA": "StartServiceCtrlDispatcherA is used by a service to connect the main thread of the process to the service control manager.", "RegCreateKeyExA": "RegCreateKeyExA is used to create a specified registry key. If the key already exists, the function opens it.", "RegCreateKeyA": "RegCreateKeyA is used to create a specified registry key. If the key already exists, the function opens it.", "RegSetValueExA": "RegSetValueExA is used to set a value and type for a given registry key.", "RegSetKeyValueA": "RegSetKeyValueA is used to set a value for a given registry key.", "RegDeleteValueA": "RegDeleteValueA is used to remove a named value from the specified registry key.", "RegEnumKeyExA": "RegEnumKeyExA is used to enumerate the subkeys of the specified open registry key.", "RegEnumValueA": "RegEnumValueA is used to enumerate the values for the specified open registry key", "RegGetValueA": "RegGetValueA is used to retrieve the type and data for the specified registry value.", "RegFlushKey": "RegFlushKey is used to write all the attributes of the specified open registry key into the registry.", "RegGetKeySecurity": "RegGetKeySecurity is used to retrieve a copy of the security descriptor protecting the specified open registry key.", "RegLoadKeyA": "RegLoadKeyA is used to create a subkey under HKEY_USERS or HKEY_LOCAL_MACHINE and loads the data from the specified registry hive into that subkey.", "RegLoadMUIStringA": "RegLoadMUIStringA is used to load the specified string from the specified key and subkey.", "RegOpenCurrentUser": "RegOpenCurrentUser is used to retrieve a handle to the HKEY_CURRENT_USER key for the user the current thread is impersonating.", "RegOpenKeyTransactedA": "RegOpenKeyTransactedA is used to open the specified registry key and associates it with a transaction", "RegOpenUserClassesRoot": "RegOpenUserClassesRoot is used to retrieve a handle to the HKEY_CLASSES_ROOT key for a specified user.", "RegOverridePredefKey": "RegOverridePredefKey is used to map a predefined registry key to the specified registry key.", "RegReplaceKeyA": "RegReplaceKeyA is used to replace the file backing a registry key and all its subkeys with another file, so that when the system is next started, the key and subkeys will have the values stored in the new file.", "RegRestoreKeyA": "RegRestoreKeyA is used to read the registry information in a specified file and copies it over the specified key.", "RegSaveKeyA": "RegSaveKeyA is used to save the specified key and all of its subkeys and values to a registry file, in the specified format.", "RegSaveKeyExA": "RegSaveKeyExA is used to save the specified key and all of its subkeys and values to a registry file, in the specified format.", "RegSetKeySecurity": "RegSetKeySecurity is used to set the security of an open registry key.", "RegUnLoadKeyA": "RegUnLoadKeyA is used to unload the specified registry key and its subkeys from the registry.", "RegConnectRegistryA": "RegConnectRegistryA is used to establish a connection to a predefined registry key on another computer.", "RegCopyTreeA": "RegCopyTreeA is used to copy the specified registry key, along with its values and subkeys, to the specified destination key.", "RegCreateKeyTransactedA": "RegCreateKeyTransactedA is used to create the specified registry key and associates it with a transaction. If the key already exists, the function opens it.", "RegDeleteKeyA": "RegDeleteKeyA is used to delete a subkey and its values from the specified platform-specific view of the registry.", "RegDeleteKeyExA": "RegDeleteKeyExA is used to delete a subkey and its values from the specified platform-specific view of the registry.", "RegDeleteKeyTransactedA": "RegDeleteKeyTransactedA is used to delete a subkey and its values from the specified platform-specific view of the registry as a transacted operation.", "RegDeleteKeyValueA": "RegDeleteKeyValueA is used to remove the specified value from the specified registry key and subkey.", "RegDeleteTreeA": "RegDeleteTreeA is used to delete the subkeys and values of the specified key recursively.", "RegCloseKey": "RegCloseKey is used to close a handle to the specified registry key.", "NtClose": "NtClose is used to close an open handle.", "NtCreateFile": "NtCreateFile is used to create a new file or directory, or opens an existing file, device, directory, or volume.", "NtDeleteKey": "NtDeleteKey is used to delete a registry key.", "NtDeleteValueKey": "NtDeleteValueKey is used to delete a registry key value.", "NtMakeTemporaryObject": "NtMakeTemporaryObject is used to change the attributes of an object to make it temporary.", "NtSetContextThread": "NtSetContextThread is used to set the usermode context of the specified thread.", "NtSetInformationProcess": "NtSetInformationProcess is used to modify information about a process such making it a critical process.", "NtSetInformationThread": "NtSetInformationThread is used to set the priority of a thread.", "NtSetSystemEnvironmentValueEx": "NtSetSystemEnvironmentValueEx is used to set a system environment variable.", "NtSetValueKey": "NtSetValueKey is used to create or replace a registry value.", "NtShutdownSystem": "NtShutdownSystem is used to shutdown the system.", "NtTerminateProcess": "NtTerminateProcess is used to terminate a process and all its threads.", "NtTerminateThread": "NtTerminateThread is used to terminate a thread.", "RtlSetProcessIsCritical": "RtlSetProcessIsCritical is used to set a process to a system critical status. This function is used by malware to prevent the process from being terminated.", "DrawTextExA": "DrawTextExA is used to draw formatted text in the specified rectangle. This function has been used by ransomware for writing ransom notes.", "GetDesktopWindow": "GetDesktopWindow is used to get a handle to the desktop window that covers the entire screen.", "SetClipboardData": "SetClipboardData is used to place data on the clipboard in a specified clipboard format.", "SetWindowLongA": "SetWindowLongA is used to changes an attribute of a specified window.", "SetWindowLongPtrA": "SetWindowLongPtrA is used to changes an attribute of a specified window.", "OpenClipboard": "OpenClipboard is used to get a handle on the clipboard.", "SetForegroundWindow": "SetForegroundWindow is used for bring the thread that created the specified window into the foreground and activates the window", "BringWindowToTop": "BringWindowToTop is used for bringing the specified window to the top of the Z order.", "SetFocus": "SetFocus is used to set the keyboard focus to the specified window", "ShowWindow": "ShowWindow is used to set the specified window's show state.", "NetShareSetInfo": "NetShareSetInfo is used to set the parameters of a shared resource.", "NetShareAdd": "NetShareAdd is used to share a server resource.", "NtQueryTimer": "NtQueryTimer is used to query a timer's attributes.", "GetIpNetTable": "The GetIpNetTable function retrieves the IPv4 to physical address mapping table. Could be used to identify hosts & mounted drives tracking ARP entries.", "GetLogicalDrives": "GetLogicalDrives is used to retrieve a bitmask representing the currently available disk drives. This function can be used to emumerate all drives / mounted drives.", "GetDriveTypeA": "GetDriveTypeA is used to determine whether a disk drive is a removable / fixed / CD-ROM / RAM disk or network drive.", "CreatePipe": "CreatePipe is used to create an anonymous pipe and returns handles to the read and write ends of the pipe. Could be used to add a sub-process for execution via cmd.", "RegEnumKeyA": "RegEnumKeyA is used to enumerate the subkeys of the specified open registry key. The function retrieves the name of one subkey each time it is called.", "WNetOpenEnumA": "The WNetOpenEnumA function starts an enumeration of network resources or existing connections. You can continue the enumeration by calling the WNetEnumResource function.", "WNetEnumResourceA": "The WNetEnumResourceA function continues an enumeration of network resources that was started by a call to the WNetOpenEnum function.", "WNetAddConnection2A": "The WNetAddConnection2A function makes a connection to a network resource and can redirect a local device to the network resource. The WNetAddConnection2 function supersedes the WNetAddConnection function.", "CallWindowProcA": "CallWindowProcA is used to pass message information to the specified window procedure.", "NtResumeProcess": "NtResumeProcess is used to resume a suspended process", "lstrcatA": "lstrcatA is used to append one string to another.", "ImpersonateLoggedOnUser": "The ImpersonateLoggedOnUser function lets the calling thread impersonate the security context of a logged-on user. The user is represented by a token handle.", "SetThreadToken": "The SetThreadToken function assigns an impersonation token to a thread. The function can also cause a thread to stop using an impersonation token.", "SizeOfResource": "SizeOfResource checks and retrieves the size of given resource. Usually found in droppers", "LockResource": "LockResource is used with FindResource(), LoadResource() and SizeOfResource() usually to work with embedded executables into the .rsrc section (droppers)", "UuidFromStringA": "UuidFromStringA is used to convert a string to a UUID. This function can be abused to both decode data and write it to memory without using common functions such as memcpy or WriteProcessMemory."}}